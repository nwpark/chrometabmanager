<div
  appMouseOver
  #headerDiv=app-mouse-over
  [ngClass]="layoutState.hidden ? 'chrome-window-header-hidden' : 'chrome-window-header'">
  <!--Action bar-->
  <div class="chrome-window-action-bar">
    <button
      class="action-button-30"
      matTooltip="Menu"
      matTooltipClass="tooltip-reduced-margin"
      mat-icon-button
      *ngIf="headerDiv.mouseOver || menuOpen"
      [matMenuTriggerFor]="menu"
      (menuOpened)="setMenuOpen(true)"
      (menuClosed)="setMenuOpen(false)">
      <mat-icon class="action-icon-18">menu</mat-icon>
    </button>
    <mat-menu #menu="matMenu">
      <ng-container *ngFor="let menuItem of actionMenuItems">
        <button
          class="menu-item"
          mat-menu-item
          [matTooltip]="menuItem.tooltip"
          matTooltipPosition="after"
          matTooltipClass="tooltip-reduced-margin"
          (click)="menuItem.callback(index)">
          <mat-icon class="menu-item-icon">{{menuItem.icon}}</mat-icon>
          <span>{{menuItem.title}}</span>
        </button>
      </ng-container>
    </mat-menu>
    <ng-container *ngFor="let button of actionButtons">
      <button
        class="action-button-30"
        mat-icon-button
        [matTooltip]="layoutState.hidden ? button.titleWhenHidden || button.title : button.title"
        matTooltipClass="tooltip-reduced-margin"
        (click)="button.callback()">
        <mat-icon class="action-icon-18">{{layoutState.hidden ? button.iconWhenHidden || button.icon : button.icon}}</mat-icon>
      </button>
    </ng-container>
  </div>
  <button
    class="chrome-window-action-bar action-button-30"
    mat-icon-button
    *ngIf="headerDiv.mouseOver && (debugModeEnabled$ | async)"
    matTooltip="Debug"
    matTooltipClass="tooltip-reduced-margin"
    (click)="debug()">
    <mat-icon class="action-icon-18">bug_report</mat-icon>
  </button>

  <!--Title text-->
  <div class="chrome-window-title">
    <div
      appMouseOver
      #titleTextDiv=app-mouse-over
      *ngIf="!showEditForm">
      <span *ngIf="lastModified">{{lastModified}}</span>
      <span *ngIf="!lastModified">{{layoutState.title}}</span>
      <span *ngIf="layoutState.hidden"> ({{chromeAPIWindow.tabs.length}} tabs)</span>
      <button
        class="action-button-30"
        mat-icon-button
        matTooltip="Edit title"
        matTooltipClass="tooltip-reduced-margin"
        *ngIf="props.isMutable && titleTextDiv.mouseOver"
        (click)="editTitle()">
        <mat-icon class="action-icon-18">edit</mat-icon>
      </button>
    </div>

    <form *ngIf="showEditForm" (ngSubmit)="submitTitleForm()">
      <input
        #titleInput
        type="text"
        [formControl]="titleFormControl"
        (blur)="submitTitleForm()"
        (keydown.enter)="submitTitleForm()"
        (keydown.escape)="cancelTitleFormEdit()">
      <button
        mat-icon-button
        class="action-button-30"
        type="submit"
        title="Save title">
        <mat-icon class="action-icon-18">save_alt</mat-icon>
      </button>
    </form>
  </div>
</div>
